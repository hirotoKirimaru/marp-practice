---
# layout: intro
layout: cover
background: https://sli.dev/demo-cover.png
---
# Pythonで早くAPI作るならFastAPIがオススメ

## KAKEAI テックディスカッション

### 2024/07/26 きり丸水上 皓登

<!-- 
プロンプト
-->

<!-- 
10分間のLTのための資料作成をします。
次のタイトルで観客を引き付けるような目次を作ってください

# Pythonで早くAPI作るならFastAPIがオススメ

 -->



<!--
転記する資料
https://docs.google.com/presentation/d/1RW6hdXOP9trEOsLC3r6eHz6-O01gxbrWOJmbp8O15N8/edit#slide=id.g1012a6ecc2d_0_6
-->

---
layout: cover
---


メリットとデメリット

メリット
フレームワークとしての完成度が高い
ライブラリが充実している
生成AIとか
Rust製のライブラリもあり、意外と悪くない

デメリット
所詮Pythonなので、限界までの速度を求められると無理
相手のマウス操作を同期させようとするとNG
処理を高速化しようと非同期に処理にしても、ライブラリ側(AWSのboto3等)が対応していないことが多い


---
layout: cover
---

# いかに早く理解するか
# いかに深く理解するか

<!-- ああ -->


---
layout: cover
---
# 理解度と時系列

---
---

# 理解度と時系列

![](/TDD/graph.png)


---
---
# 理解度と時系列

![](/TDD/graph2.png)

---
layout: cover
---

# 早く理解する方法はいろいろある

<!--
プロジェクト運営でクリティカルチェーンプロジェクトマネジメントだったり、
知識がある人と行うペアプロ・モブプロ 等々。
-->


---
layout: cover
---

# 分かりやすく効果が出やすい

# TDD を紹介します

<!--

-->

---
layout: cover
---

# TDD

## Test Driven Development
テスト駆動開発 と呼ばれる手法
短いサイクルを繰り返して開発を進める
「動作する綺麗なコード」を目指す

---
layout: cover
---

# この名称は忘れてください

---
layout: cover
---

# TDD
## Todo Driven Development

Todo 駆動開発

<!--
テストからやればテスト駆動開発だ、というのは大間違い
満たすべき仕様が事前にわかっており、その仕様を1つ1つ満たせるように実装していくやり方である
-->
---
---

# TDDのお題として有名なFizzBuzz
- 1〜100の数字を入力とする
- 3の倍数なら「Fizz」
- 5の倍数なら「Buzz」
- 3と5の両方の倍数なら「FizzBuzz」
- それ以外は数字をそのまま返す

<!--

-->

---
layout: cover
---

## TDDでよく使用されるCyber-dojo
https://beta.cyber-dojo.org/creator/home

<!--  -->

---
---

# TDDのメリット
- 仕様への理解が深まる
- 早期にバグを発見できる
- 必要な機能を無駄なく開発できる
- リファクタリングが容易になる
- テストによる安心感

---
---

# TDDの進め方
## テストケースを考える

---
---

- GIVEN
- WHEN
- THEN




BabyStep
カイジの鉄骨渡りのように小さく一歩ずつ確認していく

一足飛びに実装するのではなく、三角測量しながらテストする。

汚いコードでもいい
効率が悪くてもいい

目的のテストが実行できていれば、最初から機能を担保しきれていなくてもいい

<!--
何を確認したいかが重要。
本当はDBのアクセスした結果を元にレスポンスをさせたいかもしれないが、最初はDBやS3アクセスの必要はない。期待するJSONレスポンスが返却されていることが分かればOK。
-->

---
---
# テストケースを満たす最小のコードを書く

3の倍数ってなに？

<!-- 具体と抽象をいったりきたり -->

---
---
# 既存のテストを壊さないようにコードをリファクタリングする


---
---
# 次のテストを書く






---
---

# TDDの基本サイクル
- Red: 失敗するテストを書く
- Green: テストが通る最小限の実装をする
- Refactor: リファクタリングを行う
このサイクルを繰り返す。

---
---

# 最高と考えるTDDサイクル
- Red: 失敗するテストを書く
- Report: 失敗したテストのレポートが期待通りか確認する
- Green: テストが通る最小限の実装をする
- Refactor: リファクタリングを行う
このサイクルを繰り返す。

例：CSVアップロードしました。失敗しました。
例：CSVアップロードしました、何行目が悪いので変更してください。

例：レスポンスJSONが一致しません。 -> どこが一致しない？ -> idの値がAではなく、Bになっています。

ただ、失敗させるのではなく、失敗したことにより自分が進めるような仕組みになっているべき。

---
---
# アプローチ

TopDown/ BottomUp
どこから担保するか

TopDown はテストしづらい、その代わりに安定する
BottomUp はテストしやすい、その代わりに不安定。リファクタリングで別の場所に移動することがあるから。

水上のオススメは断然TopDown。
なぜかというと・・・

---
---

# TDDはフラクタル


https://speakerdeck.com/hirotokirimaru/testing-example-for-a-rest-api-created-with-spring-boot?slide=42

APIという単位で機能確保した後に、切り出せる箇所で細かい修正を行っていくと安心して更新できる。例えば、crudで定義していたが、usecaseに移動させたいときも、APIという断面での機能を確保できているなら間違いがない。
地味なimportミスとかを早めに気づくことができる。


---
---

# 正しいものを正しくつくる

---
# TDDブートキャンプ
## FizzBuss
## 暦で1か月

---
---

# TDDの実践ポイント
Baby Step: 小さな一歩ずつ進める
カイジの鉄骨渡りのように小さく一歩ずつ確認していく

30秒サイクル: 短いサイクルを意識する
Top-down / Bottom-up: アプローチを選択する
テストはデザイン: テストを通して設計を考える

---
---

# テストはデザイン
# 適切な設計を導いてくれる

---
---

# まとめ
TDDは「正しいものを正しくつくる」ための手法
テスト→実装→リファクタリングのサイクルを繰り返す
小さな一歩を積み重ねて開発を進める
テストを通して設計や仕様への理解を深められる
TDDを実践して、堅牢なソフトウェア開発を目指しましょう！
